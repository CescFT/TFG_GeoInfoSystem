<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mapa</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <style>
        /* Style the header with a grey background and some padding */
    .header {
      overflow: hidden;
      background-color: #f1f1f1;
      padding: 20px 10px;
    }

    /* Style the header links */
    .header a {
      float: left;
      color: black;
      text-align: center;
      padding: 12px;
      text-decoration: none;
      font-size: 18px;
      line-height: 25px;
      border-radius: 4px;
    }

    /* Style the logo link (notice that we set the same value of line-height and font-size to prevent the header to increase when the font gets bigger */
    .header a.logo {
      font-size: 25px;
      font-weight: bold;
    }

    /* Change the background color on mouse-over */
    .header a:hover {
      background-color: #ddd;
      color: black;
    }

    /* Style the active/current link*/
    .header a.active {
      background-color: dodgerblue;
      color: white;
    }

    /* Float the link section to the right */
    .header-right {
      float: right;
    }

    /* Add media queries for responsiveness - when the screen is 500px wide or less, stack the links on top of each other */
    @media screen and (max-width: 500px) {
      .header a {
        float: none;
        display: block;
        text-align: left;
      }
      .header-right {
        float: none;
      }
    }
    #map {
        height: 400px;  /* The height is 400 pixels */
        width: 100%;  /* The width is the width of the web page */
       }

    </style>


</head>
<body onload="veurecontingutvariable()">
    <div class="header">
        <a href="/" class="logo">Sistema d'informació Geogràfica</a>
        <div class="header-right">
            <a class="active" href="/">Pàgina d'inici</a>
            <a href="/">Registra't</a>
            <a href="/">Inicia sessió</a>
        </div>
    </div>

    <form method="POST" id="cercarCiutat" >
        {% csrf_token %}
        <input type="text" name="cercador" id="ciutat" placeholder="Cerca ciutat">
        <button type="submit" id="searchButton" onclick="enviarDadesMaps()">Cerca</button>

    </form>


    <div id="map"></div>

    <div id="contingutvariable">
        "{{ puntsInteres| safe }}"

    </div>

    <script>
        function enviarDadesMaps(){
            var boto=document.getElementById("searchButton");
            var input=document.getElementById("ciutat").value;
            //ni idea de com pasarli la ciutat buscada, de moment...

        }
    </script>


    <script>
        function veurecontingutvariable(){
            var divSortida = document.getElementById("contingutvariable");
            var punts=JSON.parse('{{ puntsInteres | safe }}');
            for (punt of punts){
                divSortida.innerHTML+=punt.fields.latitud;
            }
        }

    </script>



<script>
// Initialize and add the map
function initMap() {
    //Localitzem en el món Catalunya
    var catalunya = {lat: 41.8204600, lng: 1.8676800};
    // Mapa centrat a Catalunya
    var map = new google.maps.Map(document.getElementById('map'), {zoom: 4, center: catalunya});
    // Marquem els punts en el mapa.
    var punts=JSON.parse('{{ puntsInteres | safe }}');
    for (punt of punts){
        var posicioPuntInteres={lat:punt.fields.latitud, lng:punt.fields.longitud};
        var marker = new google.maps.Marker({position: posicioPuntInteres, map: map});
    }



}
    </script>
    <!--Load the API from the specified URL
    * The async attribute allows the browser to render the page while the API loads
    * The key parameter will contain your own API key (which is not needed for this tutorial)
    * The callback parameter executes the initMap() function
    -->
    <script async defer
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDZYY_D7EaLWIBwLuuXQOM2PSpsTD-5kMs&callback=initMap">
</script>


</body>
</html>